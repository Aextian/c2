import{j as e,r as l,a as v,L as V}from"./app-tI2J1YsO.js";import{y as N,A as E}from"./app-layout-B3t13f0S.js";import{C as R,I as B}from"./InputFile-BiS-BWjO.js";import{c as P,B as C}from"./createLucideIcon-DVLgItX8.js";import{L as q}from"./label-C31aROhU.js";import{S as k,a as D,b as L,c as A,d as G,e as z,f as d,C as H,g as J}from"./select-BvhsFAjv.js";import{T as K}from"./textarea-DWYhbVOt.js";import"./index-CaKbJXop.js";import"./index-w0u4n437.js";import"./input-DmEn5zn0.js";import"./badge-BhpZlgco.js";import"./index-po8darRK.js";function T({className:t,...r}){return e.jsx("div",{"data-slot":"skeleton",className:P("bg-primary/10 animate-pulse rounded-md",t),...r})}const M=({cordinator_task:t,fetchCordinatorTasks:r})=>{var y,w;const[o,j]=l.useState(!1),[g,c]=l.useState(""),[x,u]=l.useState(t.status),[h,a]=l.useState(!1),[i,m]=l.useState(!1),b=l.useRef(null),[p,S]=l.useState({comment:"",file_path:""}),U=async s=>{s.preventDefault(),a(!0);try{const n={subTaskId:t.sub_task_id,comment:p.comment,filePath:p.file_path},f=await v.post(route("users-tasks.comment"),n,{headers:{"Content-Type":"multipart/form-data"}});r(),f.status===200&&(S({comment:"",file_path:""}),c(""),b.current&&(b.current.value="")),a(!1)}catch(n){console.log(n),N.error("Something went wrong"),a(!1)}},I=s=>{const{value:n}=s.target;S({...p,comment:n})},F=async s=>{s.preventDefault(),m(!0);try{const n=route("users-tasks.update-status",{id:t.id}),f=await v.post(n,{status:x});f.status===200&&(N.success(f.data.message),r(),m(!1))}catch(n){console.log(n),m(!1),N.error("Something went wrong")}};return e.jsxs("div",{className:"shadow-sidebar-border p-5 shadow-lg",children:[e.jsxs("span",{className:"text-xs",children:["Created: ",new Date(t.created_at||"").toDateString()]}),e.jsxs("div",{className:"mt-10",children:[e.jsx("span",{className:"font-bold",children:"Title: "}),e.jsx("span",{children:(y=t.sub_task.task)==null?void 0:y.title})]}),e.jsx("div",{className:"col-span-2 flex justify-end",children:e.jsxs("form",{onSubmit:s=>F(s),className:"flex flex-col items-end justify-end gap-5",children:[e.jsx(q,{children:"Status"}),e.jsxs(k,{value:x,onValueChange:s=>u(s),children:[e.jsx(D,{className:"] w-[100px]",children:e.jsx(L,{placeholder:"Please Select Status"})}),e.jsx(A,{children:e.jsxs(G,{children:[e.jsx(z,{children:"Status"}),e.jsx(d,{value:"todo",children:"Todo"}),e.jsx(d,{value:"doing",children:"Doing"}),e.jsx(d,{value:"done",children:"Done"})]})})]}),e.jsx(C,{disabled:i,type:"submit",className:"] w-[100px]",children:i?"Updating...":"Update"})]})}),e.jsxs("div",{className:"mt-5 mb-10 flex gap-5",children:[e.jsx("h2",{className:"font-bold",children:"Task:"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:t.sub_task.content})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"my-5 flex items-center gap-2 font-bold hover:cursor-pointer",onClick:()=>j(!o),children:[e.jsx("p",{children:"Comments"}),e.jsx("span",{children:o?e.jsx(H,{}):e.jsx(J,{})})]}),o&&e.jsx("ul",{className:"my-5 flex flex-col gap-2 text-xs",children:e.jsx("li",{children:Array.isArray((w=t==null?void 0:t.sub_task)==null?void 0:w.comments)&&t.sub_task.comments.length>0?t.sub_task.comments.map(s=>e.jsx(R,{comment:s,sending:h,fetchCordinatorTasks:r},s.id)):e.jsx("p",{className:"text-gray-500",children:"No comments ."})})}),e.jsxs("form",{onSubmit:s=>U(s),children:[e.jsx(K,{required:!0,value:p.comment||"",onChange:s=>I(s),placeholder:"write your comment"}),e.jsx("div",{className:"mt-5 flex justify-center md:justify-end",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(B,{setData:S,setFileName:c,fileRef:b,fileName:g}),e.jsx(C,{className:"px-10",disabled:h,children:"Send"})]})})]})]})]})},le=()=>{const[t,r]=l.useState(!0),[o,j]=l.useState([]),[g,c]=l.useState([]),x=[{title:"Tasks",href:"/tasks"}],u=async()=>{r(!0);const i=(await v.get(route("user-tasks"))).data;j(i),c(i),r(!1)};l.useEffect(()=>{u()},[]);const h=a=>{if(a==="all")c(o);else{const i=o.filter(m=>m.status===a);c(i)}};return e.jsxs(E,{breadcrumbs:x,children:[e.jsx(V,{title:"tasks"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsxs("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 rounded-xl border md:min-h-min md:p-10",children:[e.jsx("div",{className:"mb-10",children:e.jsxs(k,{onValueChange:a=>h(a),defaultValue:"all",children:[e.jsx(D,{className:"w-[180px]",children:e.jsx(L,{placeholder:"Filter"})}),e.jsxs(A,{children:[e.jsx(d,{value:"all",children:"All"}),e.jsx(d,{value:"todo",children:"Todo"}),e.jsx(d,{value:"doing",children:"Doing"}),e.jsx(d,{value:"done",children:"Done"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-2",children:g.map(a=>e.jsx(M,{cordinator_task:a,fetchCordinatorTasks:u},a.id))}),t?e.jsxs("div",{className:"grid h-full w-full grid-cols-1 gap-5 md:grid-cols-2",children:[e.jsx(T,{className:"h-[600px] w-full rounded-xl"}),e.jsx(T,{className:"h-[600px] w-full rounded-xl"})]}):o.length===0&&e.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"No tasks"})]})})]})};export{le as default};
