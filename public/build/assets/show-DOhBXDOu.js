import{r as l,j as s,L as N,a as x}from"./app-tI2J1YsO.js";import{B as v}from"./createLucideIcon-DVLgItX8.js";import{T as k}from"./textarea-DWYhbVOt.js";import{A as y,y as w}from"./app-layout-B3t13f0S.js";import"./index-CaKbJXop.js";import"./index-w0u4n437.js";const B=({id:c})=>{const[p,m]=l.useState(!1),[u,f]=l.useState([]),[n,d]=l.useState([{sub_task_id:null,comment:""}]),j=[{title:"Tasks",href:"/tasks"}],h=async a=>{var t;const r=(await x.get(route("get-task",{id:a}))).data;f((r==null?void 0:r.sub_tasks)||[]),d(((t=r.sub_tasks)==null?void 0:t.map(o=>({sub_task_id:o.id,comment:""})))||[])};l.useEffect(()=>{h(c)},[c]);const g=async(a,e)=>{a.preventDefault(),m(!0);try{const r={subTaskId:n[e].sub_task_id,comment:n[e].comment},t=await x.post(route("users-tasks.comment"),r);h(c),t.status===200&&d(o=>{const i=[...o];return i[e]={...i[e],comment:""},i}),m(!1)}catch(r){console.log(r),w.error("Something went wrong"),m(!1)}},b=(a,e)=>{const{value:r}=a.target;d(t=>{const o=[...t];return o[e]={...o[e],comment:r},o})};return s.jsxs(y,{breadcrumbs:j,children:[s.jsx(N,{title:"task"}),s.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:s.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 rounded-xl border p-10 md:min-h-min",children:s.jsx("div",{className:"grid grid-cols-2 gap-5",children:u.map((a,e)=>{var r;return s.jsxs("div",{className:"shadow-sidebar-border p-5 shadow-lg",children:[s.jsxs("div",{className:"mb-10 flex gap-5",children:[s.jsx("h2",{className:"font-bold",children:"Title:"}),s.jsx("span",{className:"font-semibold text-gray-900 first-letter:uppercase dark:text-white",children:(r=a.task)==null?void 0:r.title})]}),s.jsxs("div",{className:"mb-10 flex gap-5",children:[s.jsx("h2",{className:"font-bold",children:"Task:"}),s.jsx("span",{className:"text-gray-900 dark:text-white",children:a.content})]}),s.jsxs("div",{className:"",children:[s.jsx("ul",{className:"my-5 flex flex-col gap-2 text-xs",children:s.jsx("li",{children:Array.isArray(a==null?void 0:a.comments)&&a.comments.length>0?a.comments.map(t=>{var o;return s.jsxs("div",{className:"mb-2",children:[s.jsxs("span",{className:"font-bold tracking-widest",children:[((o=t.user)==null?void 0:o.name)||"Unknown User",":"]})," ",t.comment]},t.id)}):s.jsx("p",{className:"text-gray-500",children:"No comments ."})})}),s.jsxs("form",{onSubmit:t=>g(t,e),children:[n[e]&&n[e].sub_task_id&&s.jsx(k,{value:n[e].comment||"",onChange:t=>b(t,e),placeholder:"write your comment"}),s.jsx("div",{className:"mt-5 flex justify-end",children:s.jsx(v,{className:"px-10",disabled:p,children:"Send"})})]})]})]},e)})})})})]})};export{B as default};
