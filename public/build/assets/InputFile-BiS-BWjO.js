import{j as e,r as m,m as B,a as D}from"./app-tI2J1YsO.js";import{B as L}from"./createLucideIcon-DVLgItX8.js";import{T as I}from"./textarea-DWYhbVOt.js";import{I as C}from"./input-DmEn5zn0.js";import{B as x}from"./badge-BhpZlgco.js";import{L as y}from"./label-C31aROhU.js";function T({fileRef:s,setData:o,setFileName:c,fileName:r}){const d=t=>{const{files:l}=t.target;l&&l.length>0&&(c(l?l[0].name:""),o(p=>({...p,file_path:l[0]})))};return e.jsxs("div",{className:"flex max-w-xs items-center justify-end gap-1.5",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"ml-20 w-36 truncate text-xs text-green-500",children:r}),e.jsx(y,{children:e.jsx(x,{onClick:()=>{var t;return(t=s.current)==null?void 0:t.click()},variant:"outline",children:"File"})})]}),e.jsx(C,{ref:s,onChange:d,type:"file",className:"hidden"})]})}const G=({comment:s,sending:o,fetchCordinatorTasks:c})=>{var w,N,b;const[r,d]=m.useState(!1),[t,l]=m.useState(!1),[p,j]=m.useState(""),u=m.useRef(null),{post:k,data:F,setData:g,clearErrors:S,reset:R,processing:_}=B({content:"",file_path:""}),E=(n,a)=>{n.preventDefault();const f=route("reply-comment.store",a);k(f,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{c(),R(),S(),u.current&&(u.current.value="",j(""))},onError:i=>{console.log(i)}})},h=t?s.replies:(w=s.replies)==null?void 0:w.slice(0,1),v=async n=>{const a=await D.get(route("download"),{params:{file_path:n},responseType:"blob"}),f=window.URL.createObjectURL(new Blob([a.data])),i=document.createElement("a");i.href=f,i.setAttribute("download",n.split("/").pop()||"downloaded_file"),document.body.appendChild(i),i.click(),document.body.removeChild(i)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-2",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold tracking-widest",children:[(N=s.user)==null?void 0:N.name,":"]})," ",s.comment]}),s.file_path&&e.jsx(x,{className:"mt-2 text-[10px] hover:cursor-pointer",variant:"outline",onClick:()=>v(s.file_path),children:"Download File"}),e.jsx("button",{className:"mt-2 ml-10 text-blue-500 hover:underline",onClick:()=>d(!r),children:"Reply"}),h==null?void 0:h.map(n=>{var a;return e.jsxs("div",{className:"mx-10 mt-4",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-bold tracking-widest",children:(a=n.user)==null?void 0:a.name}),": ",n.content]}),n.file_path&&e.jsx(x,{className:"mt-2 text-[10px] hover:cursor-pointer",variant:"outline",onClick:()=>v(n.file_path),children:"Download File"})]},n.id)}),((b=s.replies)==null?void 0:b.length)!==void 0&&s.replies.length>1&&!t&&e.jsx("button",{className:"ml-10 text-blue-500 hover:underline",onClick:()=>l(!0),children:"View or more replies"}),r&&e.jsxs("form",{className:"mx-10 mt-5",onSubmit:n=>E(n,s.id),children:[e.jsx(I,{value:F.content,onChange:n=>g(a=>({...a,content:n.target.value})),placeholder:"Enter your reply...",required:!0}),e.jsxs("div",{className:"mt-5 flex flex-col justify-end gap-2",children:[e.jsx(T,{fileRef:u,setData:g,setFileName:j,fileName:p}),e.jsx(L,{className:"self-end px-10",disabled:o||_,children:"Send"})]})]})]})})};function H({setData:s,setFileName:o,fileName:c,fileRef:r}){const d=t=>{const{files:l}=t.target;l&&l.length>0&&(o(l?l[0].name:""),s(p=>({...p,file_path:l[0]})))};return e.jsxs("div",{className:"flex max-w-xs items-center justify-end gap-1.5",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"ml-20 w-36 truncate text-xs text-green-500",children:c}),e.jsx(y,{children:e.jsx(x,{onClick:()=>{var t;return(t=r.current)==null?void 0:t.click()},variant:"outline",children:"File"})})]}),e.jsx(C,{ref:r,onChange:t=>d(t),type:"file",className:"hidden"})]})}export{G as C,H as I};
